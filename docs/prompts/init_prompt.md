Я хочу реализовать библиотеку (название: PContext) на Python для windows 10/11 (в приоритете) и Linux (Ubuntu), которая бы позволяла вставлять Python скрипты в контекстное меню (нажатие правой кнопки мыши на файле/файлах/папке/папках, либо в пустой области). Это должно примерно так: пользователь пишет свой скрипт, перемещает в определённую папку, где библиотека может найти этот файл, запускает данную библиотеку, чтобы данная библиотека зарегистрировала данный скрипт, и теперь данный скрипт может выполняться при вызове контекстного меню (на определённых файлах).

Некоторые мысли:

- все скрипты могут быть либо одноразовыми - служат для выполнения задачи единоразово, либо сервисами - инициализирует модели и предоставляют их по запросу.
- в начале скрипта пользователь должнен указать информацию: название (которое будет отображаться в контекстном меню); типы данных, на которых должен вызываться скрипт; библиотеки, которые должны быть установлены; возможные зависимости в виде других скриптов, параметры.
- не все Python файлы должны восприниматься как скрипты для контекстного меню, например вспомогательный файл utils.py не должен быть виден из контекстного меню, он лишь является вспомогательным для других скриптов, который может находиться там же, где и основной скрипт.
- библиотека должна предоставить удобный интерфейс для обработки ошибок, warnings и так далее. Например, если скрипту на вход был предоставлен файл, который не соответствует определённым критериям для данного скрипта, то скрипт может вызвать ошибку, а библиотека должна её перехватить и вывести пользователю в удобном формате (в окне).
- скрипты в контекстном меню должны находиться не в главном констекстном меню, а в подменю "PContext"
- скрипты могут быть сгруппированы: группировка происходит с помощью папок.
- у скриптов могут быть параметры, которые можно менять. Эти параметры (их типы, диапозоны и значения по-умолчанию) должны быть указаны в информации в скрипте.
- у запущенной программы (библиотеки) должен быть tray icon, с помощью которого можно наблюдать за запущенными скриптами и сервисами, а также через него можно настраивать программу и параметры скриптов. Через tray icon можно досрочно завершить скрипты.
- у любого скрипта не должно быть зависимости от нашей библиотеки, входные пути, параметры, модели должны передаваться через входные параметры основной функции в скрипте,
- любому скрипту можно задать timeout: если это одноразовый скрипт - это максимальное время выполнения скрипта, если речь про сервис - то это максимальное время простоя (без работы). Если timeout был достигнут, то скрипт должен завершиться, а пользователь должен быть уведомлён.
- если главная функция скрипта выдаёт что-то (кроме None), то это что-то нужно открыть в стандартной программе. Например, если это изображение, открываем изображением в программе обозревателя изображений, установленной по умолчанию в операционной системе. Если это текст, то копируем текст в буфер обмена и говорит об этом пользователю. Если это ссылка, то открываем её в браузере по умолчанию. И так далее... Если это медиафайл, то функция скрипта будет передавать не байтовые данные, а путь к медиафайлу (`{"image": "<image_path">}`, типы данных: "image", "video", "text", "link", "pdf", "doc", можешь добавить ещё). Функцию автоматического открытия можно отключить.
- если у скрипта нет входных данных, то должна быть возможность запускать данный скрипт из tray

Примеры скриптов:

- загрузчик файлов на облачный сервер
- детектор объектов на изображениях, состоит из двух частей: скрипт, который запускает (инициализирует) yolo модель (если он не запущен) и останавливает данную модель (если модель запущена) и освобождает ресурсы; а так же скрипт, который находит объекты на изображениях (с помощью запущенной Yolo модели), визуализирует результат и показывает пользователю. Второй скрипт может работать только при запущенной модели Yolo. Если Yolo модель долго стоит без дела, то она автоматически выключается. Так же модель можно остановить через tray icon.

Примечания:

- UI выбираешь сам, главное, чтобы оно было быстрым и не уродливым.
- Python-версия: ≥ 3.10
- Автоустановки зависимостей при регистрации скрипта.
- conda не нужен.
- Считаем, что пользователь доверяет своим скриптам

Пока не пиши код, а тщательно продумай решение. Я жду твои мысли, замечания, советы. Не стесняйся задавать вопросы, если они есть. Я хочу, чтобы не было белых пятен перед разработкой библиотеки.

---

1. Windows 11: я отключил новое контекстное меню, теперь оно у меня как в windows 10 - делай для него.
2. Устраивает
3. Делай как считаешь нужным
4. Да
5. Опция «всегда показывать диалог параметров перед запуском» НЕ НУЖНА. Все настройки параметры - через tray или через описание скрипта
6. Как считаешь нужным
7. Храни 50 последних логов, но без артефактов, только текст: информация о запуске: какой скрипт, когда, время выполнения и так далее
8. Как считаешь нужным. Оптимизация была бы желательна
9. Documents/PContext/scripts и ~/PContext/scripts

Теперь давай перейдём к реализации: тщательно продумай архитектуру проекта и напиши его структуру
